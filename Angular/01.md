# Angular 9 - Partie 1 : DÃ©couverte de Angular - Cours
> - [Retourner Ã  la liste des cours](../readme.md)
> - Exercices : [cliquez-ici](exercices.md)
> - Corrections : [cliquez-ici](corrections.md)

- [Angular 9 - Partie 1 : DÃ©couverte de Angular - Cours](#angular-9---partie-1--d%c3%a9couverte-de-angular---cours)
  - [1. Vue d'ensemble](#1-vue-densemble)
    - [PrÃ©sentation de Angular](#pr%c3%a9sentation-de-angular)
    - [Pourquoi Angular ?](#pourquoi-angular)
    - [Euh, Typescript ?](#euh-typescript)
  - [Les outils nÃ©cessaires](#les-outils-n%c3%a9cessaires)
    - [Node.js](#nodejs)
    - [NPM](#npm)
    - [Installation](#installation)
  - [Notre premiÃ¨re application Angular](#notre-premi%c3%a8re-application-angular)
  - [Notre premier projet !](#notre-premier-projet)
    - [Installer une premiÃ¨re dÃ©pendance](#installer-une-premi%c3%a8re-d%c3%a9pendance)
      - [Euh, mais Ã§a s'installe oÃ¹ tout Ã§a ?](#euh-mais-%c3%a7a-sinstalle-o%c3%b9-tout-%c3%a7a)
    - [DÃ©clarer Bootstrap dans le projet](#d%c3%a9clarer-bootstrap-dans-le-projet)
    - [Lancer notre projet Angular](#lancer-notre-projet-angular)
    - [Exercice](#exercice)
  - [> Supprimez tout (oui, tout !) le contenu de ce fichier et Ã©crivez un simple `<h1>Hello World</h1>`. Actualisez... Euh non, n'actualisez pas : la page devrait s'actualiser toute seule Ã  chaque sauvegarde de fichier !](#blockquote-supprimez-tout-oui-tout--le-contenu-de-ce-fichier-et-%c3%a9crivez-un-simple-h1hello-worldh1-actualisez-euh-non-nactualisez-pas--la-page-devrait-sactualiser-toute-seule-%c3%a0-chaque-sauvegarde-de-fichier--blockquote)
  - [Notre premier component](#notre-premier-component)

> Angular est un framework Javascript qui permet de composer des applications web de type SPA (Single Page Application). 

> Nous allons voir les concepts clÃ©s et tout ce que vous avez besoin de savoir  pour construire votre premiÃ¨re application Angular.

## 1. Vue d'ensemble

### PrÃ©sentation de Angular

Jusqu'Ã  prÃ©sent, vous savez dÃ©velopper un site en HTML/CSS et en Javascript. Depuis les dÃ©buts du web, des technologies sont venues en surcouche Ã  ces trois langages de base pour rendre les pages plus accessibles, dynamiques, modernes.

Autour de 2005, la technologie AJAX est arrivÃ©e (Asynchronous Javascript And XML) qui permettait d'exÃ©cuter des requÃªtes HTTP (c'est Ã  dire demander quelque chose Ã  un serveur web) sans recharger la page ! Jusque alors, la seule maniÃ¨re que nous avions d'afficher un contenu diffÃ©rent dans une page, c'Ã©tait de faire des liens en HTML vers une autre page contenant les nouvelles donnÃ©es.

Avec AJAX, on Ã©tait alors capables de faire quelque chose de novateur : exÃ©cuter cette demande de nouveau contenu (donc, cette requÃªte, qu'on appelle une requÃªte HTTP), alors mÃªme que nous restions sur la mÃªme page !

Aujourd'hui les requÃªtes AJAX restent trÃ¨s utilisÃ©es. Par exemple sur Twitter: lorsque vous scrollez tout en bas de la page d'accueil, un Ã©vÃ¨nement est dÃ©clanchÃ© en Javascript lorsque vous touchez le bas de la page, et la fonction dÃ©clanchÃ©e Ã  ce moment dit quelque chose comme : "rÃ©cupÃ¨re-moi les tweets suivants et ajoute-les Ã  la suite, dans le DOM". Et tout Ã§a, sans recharger la page !

Il y aussi jQuery, qui est crÃ©Ã© vers 2006 : en fait, jQuery n'ajoute pas vraiment de fonctionnalitÃ©s (lÃ  oÃ¹ AJAX est une rÃ©elle nouvelle technologie), en fait, il nous permet d'utiliser ce que  Javascript nous permet dÃ©jÃ  mais... plus facilement et de faÃ§on optimisÃ©e par rapport Ã  ce que les navigateurs permettaient Ã  l'Ã©poque !

On commence alors Ã  savoir faire des sites web intÃ©ressants grÃ¢ce Ã  Javascript, qui auparavant Ã©tait plutÃ´t boudÃ© des dÃ©veloppeurs car peu optimisÃ© et servant surtout Ã  de l'apparÃ¢t visuel plus qu'Ã  des fonctionnalitÃ©s rÃ©elles.

Arrive vers 2010 AngularJS, la premiÃ¨re version de Angular, par Google. C'est enfin une boÃ®te Ã  outils complÃ¨te, un framework, qui permet de dÃ©velopper des SPA (Single Page Applications), c'est Ã  dire des applications web contenues sur une seule page dynamique. L'avantage d'utiliser un framework pour cela, c'est qu'il nous donne une sÃ©rie de conventions et une ligne de conduite Ã  tenir pour coder et organiser notre projet.

Ã€ partir de la version 2, AngularJS (donc, la version 1), est renommÃ©e Angular. C'est une rÃ©Ã©criture complÃ¨te du framework pour le simplifier et l'optimiser grandement. Nous en sommes aujourd'hui Ã  la version 9 !

### Pourquoi Angular ?

Depuis, de nombreux autres frameworks ont vu le jour : Angular, mais aussi React, Vue.js pour les plus utilisÃ©s.

> Tous ont leurs avantages et inconvÃ©nients, et comme souvent en programmation : **soyez agnostiques !** Choisissez vos outils en fonction de vos besoins, et ensuite en fonction de vos goÃ»ts.

- Angular est un framework trÃ¨s robuste, dont la courbe d'apprentissage peut effrayer. En fait, Angular est plus difficile Ã  aborder de prime abord mais on se retrouve avec des compÃ©tences et des bonnes pratiques qui accÃ©lÃ¨rent nettement le dÃ©veloppement de notre projet par la suite !

![react/angular/vue](img/angular_vs_react_vs_vue.png)

- Angular permet de bien structurer ses fonctionnalitÃ©s (les composants) et possÃ¨de un robuste ensemble d'outils prÃªts Ã  l'emploi (un routeur, un moteur de template, du stockage local, une gestion des erreurs poussÃ©e...)

- React, de base, ne possÃ¨de que la partie composants et templating. Il est pratique pour crÃ©er des composants isolÃ©s dans votre site.

- Vue est intÃ©ressant pour transformer une application web dÃ©jÃ  existante, morceau par morceau, lÃ  oÃ¹ Angular est un projet complet dÃ¨s le dÃ©part

- Angular utilise Typescript !

### Euh, Typescript ?

Typescript est Ã  Javascript ce que SASS est Ã  CSS : c'est un "sur-langage" qui sera transtypÃ©, ou "traduit", en Javascript. Pourquoi l'utiliser ? Car l'un des reproches fait Ã  Javascript est son cÃ´tÃ© trÃ¨s laxiste, permissif et peu cohÃ©rent dans sa structure, qui laisse passer trop facilement un code buguÃ© ou mal optimisÃ©. En fait, Typescript est un Javascript en trÃ¨s strict ! Il ne laisse passer aucune erreur (l'application ne fonctionnera simplement pas !), ce qui vous force Ã  coder mieux et plus proprement... Pour au final, avoir un code mieux organisÃ© et plus maintenable.

## Les outils nÃ©cessaires
Les frameworks Javascript utilisent Node et NPM pour gÃ©rer leurs dÃ©pendances, c'est Ã  dire l'ensemble des outils nÃ©cessaires Ã  leur fonctionnement.

### Node.js
Node.js est un serveur web (Ã  l'opposÃ© d'un client web qui demande des pages web, le serveur web distribue des pages web) Ã©crit en Javascript. Bien que Angular soit bel et bien une technologie de front (donc, cÃ´tÃ© client), nous avons besoin de Node.js pour utiliser des outils de ligne de commande qui nous permettront de "compiler" notre code, c'est Ã  dire transformer le code source en un code comprÃ©hensible par le navigateur web.

### NPM
NPM (Node Package Manager) est l'outil de gestions de dÃ©pendances de Node.js. Un gestionnaire de dÃ©pendances, c'est en fait un outil qui va lire la liste des dÃ©pendances de notre projet (par exemple: j'ai besoin d'un outil de traduction, de Boostrap, de telle et telle librairies...).

On peut consulter les packages (ou paquets, ou dÃ©pendances, ou libraries, ou bibliothÃ¨ques) sur le site de NPM : https://www.npmjs.com/

L'avantage d'un gestionnaire de dÃ©pendances, c'est qu'avec quelques lignes de commandes, il maintiendra Ã  jour toutes les dÃ©pendances du projet ! C'est nettement plus simple que d'avoir plein de lignes `script` ou `link` et de devoir vÃ©rifier pour chaque dÃ©pendance CSS ou JS s'il y a une mise Ã  jour.

L'intÃ©rÃªt aussi est de "gÃ©rer les dÃ©pendances" : par exemple, j'ai besoin de la librairie DataTables pour rendre mes tableaux triables en Javascript. Cette dÃ©pendance a elle-mÃªme besoin de jQuery. Jusqu'Ã  prÃ©sent, je devais d'abord importer jQuery dans mon code puis importer DataTables pour que tout fonctionne.

Avec NPM, je peux simplement indiquer que j'ai besoin de DataTables pour qu'il s'occupe d'importer toutes les sous-dÃ©pendances !

> Exemple: allez jeter un oeil sur les dÃ©pendances du paquet [@angular/cli](https://www.npmjs.com/package/@angular/cli). En requÃ©rant ce package, il y a  20 autres dÃ©pendances qui s'installeront automatiquement et qui se maintiendront Ã  jour toutes seules !

### Installation

- TÃ©lÃ©chargez et installez la derniÃ¨re version **LTS** de Angular : https://nodejs.org/en/download/
- Une fois installÃ©, ouvrez un terminal et tapez `node -v` (comme "version") : si une version de Node s'affiche, c'est que tout fonctionne ! Sinon, il a probablement un bug.
![nodev](img/nodev.png)

- Ensuite, saisissez `npm install -g npm@latest` pour installer la derniÃ¨re version de NPM sur votre machine. Une fois l'installation terminÃ©e, vÃ©rifiez si la version apparaÃ®t avec `npm -v` :
![npmv](img/npmv.png)

- Enfin, installez la ligne de commande de Angular sur votre machine avec : `npm install -g @angular/cli`

> - `npm`, c'est l'outil, le gestionnaire de package
> - `install`, c'est pour installer une dÃ©pendance
> - `-g`, c'est pour l'installer de partout dans la machine et non pas seulement dans le dossier actuel du terminal
> -`@angular`, c'est le dÃ©veloppeur de la dÃ©pendance
> - `cli`, c'est le nom de la dÃ©pendance !

Une fois installÃ©, vÃ©rifiez la version, cette fois avec... `ng version` (Pourquoi pas `-v` ? Aucune idÃ©e !)

![ng version](img/ngversion.png)

Ã‡a y est, les outils sont prÃªts !

## Notre premiÃ¨re application Angular

Pour commencer, crÃ©ez un dossier dans lequel vous stockerez vos projets Angular. Il peut Ãªtre n'importe oÃ¹ dans votre ordinateur, mais Ã©vitez de le mettre dans un dossier qui est gÃ©rÃ© par un drive (Dropbox, Google Drive, One Drive, iCloud...).

> En fait, on aura des dizaines de milliers de fichiers (hein, quoi ? Oui oui) qui vont s'installer pour gÃ©rer notre projet. Rappellez-vous le gestionnaire de dÃ©pendances ! Un paquet dÃ©pend de plusieurs autres, qui eux-mÃªme dÃ©pendent de plusieurs autres... et ainsi de suite !

> Mais alors, comment je sauvegarde ou partage mon projet du coup ? Ã‡a, Ã§a sera le rÃ´le de Git !

Ouvrez maintenant ce dossier avec un terminal :
- Sous Windows, ouvrez le dossier en question puis cliquez dans la barre d'adresses du dossier. Dedans, saisissez `cmd` : un terminal s'ouvrira pile dans le bon dossier !

- Sous Mac, ouvrez `Terminal` puis naviguez jusqu'au dossier en question. Pour cela :
  - `ls` permet de visualiser le dossier en cours
  - `cd nomDuDossier` permet de rentrer dans le dossier `nomDuDossier`
  - `cd ..` permet de remonter d'un cran dans l'arobrescence de dossiers 
  - Par exemple, pour aller dans le dossier `projects` :
![cd et ls](img/cdprojects.png)

Ensuite, une fois dans ce dossier, saisissez la commande suivante :

`ng new firstProject --style=scss --skip-tests=true`
Puis saisissez `y` Ã  la question posÃ©e.

![ng new](img/ngnew.png)

Un dossier `firstProject` contenant des tas de fichiers et dossiers va se crÃ©er ! Cela prend plus ou moins de temps la premiÃ¨re fois.

Ici, on crÃ©Ã©e donc un projet grÃ¢ce Ã  `ng new` que l'on nomme `firstProject`. On ajoute des options facultatives qui nous permettent de prÃ©ciser que nous utiliserons SASS pour les CSS et que nous ne souhaitons pas utiliser les tests unitaires de Angular (ce sont des fichiers oÃ¹ nous dÃ©finissons un comportement de l'application afin de vÃ©rifier si ce comportement marche ou pas).

## Notre premier projet !

Ã‡a y est, nous y sommes ! Notre premier projet Angular est maintenant crÃ©Ã©. Vous allez maintenant l'ouvrir dans Visual Studio Code.

> **ATTENTION !** Faites extrÃªmement attention Ã  ce qui va suivre. Promis, c'est facile ! Visual Studio Code ou tout autre IDE ne fonctionne bien que si, et seulement si, vous respectez la consigne suivante : vous devez **obligatoirement** ouvrir le dossier du projet dans lequel vous travaillez, dans VSCode !

Voici une fenÃªtre VSCode de base :
![VSCode](img/vscodebase.png)

Cliquez sur `Open Folder` ou `Fichier > Ouvrir un dossier` ou `Files > Open Folder` afin d'ouvrir le dossier `firstProject`.

C'est vraiment trÃ¨s important, soyez vigilants ! Il ne faut pas ouvrir non plus un dossier en dessus (par exemple, s'il est stockÃ© dans `C:\Mes Documents\cours\firstProject`, vous ne devez pas ouvrir `cours` mais bien `firstProject` !)

Pour Ãªtre bien sÃ»rs, vous devez avoir le dossier `firstProject` indiquÃ© comme ci-dessous :

![firstProject](img/vscodeFirstProject.png)

> Cette pratique est Ã  respecter dorÃ©navant pour tous le code que nous verrons ensemble Ã  l'avenir, car nous travaillerons uniquement en mode "projet" et plus sur des fichiers isolÃ©s !

### Installer une premiÃ¨re dÃ©pendance

Maintenant que votre VSCode est ouvert au bon endroit, vous pouvez ouvrir un terminal, cette fois directement dans VSCode. Vous pouvez aller dans `Terminal > New Terminal` (le raccourci clavier est indiquÃ© sur le bouton, retenez-le car on va s'en servir trÃ¨s souvent ðŸ˜‰)

> Vous pouvez remarquer que le terminal est dÃ©jÃ  ouvert au bon endroit, c'est un des avantages d'ouvrir le dossier du projet correctement !
![VSCode Terminal](img/vscodeterminal.png)

Indiquons dans le terminal que nous allons utiliser Boostrap :

```
npm i bootstrap
```

> Cette fois, pas de `-g` ! Je ne veux pas installer Boostrap sur toute ma machine (bien que Windows stylisÃ© en Boostrap peut Ãªtre... Euh, je m'Ã©gare lÃ ), mais uniquement dans le projet en cours, c'est Ã  dire celui dont j'ai le dossier d'ouvert.

> Et cette fois, `i` plutÃ´t que `install` ! C'est juste un raccourci.

![npm i bootstrap](img/npmibootstrap.png)

Jetez un oeil Ã  `package.json` : ce fichier contient la liste des dÃ©pendances de notre projet. De base, Angular a besoin de beaucoup d'outils pour fonctionner ! En fouillant un peu, on peut voir notre nouvelle dÃ©pendance :

![composer.json Bootstrap](img/composerjsonbootstrap.png)

#### Euh, mais Ã§a s'installe oÃ¹ tout Ã§a ?

Parmi tous les fichiers et dossiers du projet, un dossier est grisÃ© : c'est `node_modules`. C'est dans ce dossier que toutes les dÃ©pendances seront installÃ©es. **Il est interdit d'y toucher !** Vous ne pouvez pas modifier les fichiers qui s'y trouvent ! En fait, comme NPM gÃ¨re toutes ces dÃ©pendances, en cas de mise Ã  jour (et avec tous ces paquets, il en a beaucoup), il va simplement effacer vos modifications au profit de la version publique de la dÃ©pendance. Il existe d'autres maniÃ¨res de faire lorsque nous avons besoin de modifier une dÃ©pendance, mais Ã§a viendra plus tard !

C'est aussi dans ce dossier oÃ¹ se trouvent plusieurs milliers de fichiers (61 000 pour l'instant !).

S'il est grisÃ©, c'est que Git, qui est dÃ©jÃ  prÃ©sent dans le projet (`ng new` a fait Ã§a seul !) ne le prÃ©voit pas dans sa sauvegarde. En effet, on n'a pas du tout besoin de partager ce dossier `node_modules` ni de l'enregistrer oÃ¹ que ce soit quand on partage/sauvegarde le projet !

Pourquoi ?

Eh bien car nous avons `package.json` qui contient dÃ©jÃ  la liste des dÃ©pendances ! Ainsi, il est bien plus simple de se partager le projet sans `node_modules` et de s'envoyer plutÃ´t le projet avec `package.json`. Il suffira une fois le projet rÃ©cupÃ©rÃ©, de faire `npm install` dans le dossier du projet pour que NPM lise `package.json` et installe toutes les dÃ©pendances !

### DÃ©clarer Bootstrap dans le projet

Pour que Angular prenne notre Bootstrap (installÃ© dans node_modules donc) en style, modifiez le fichier `src/angular.json` et ajoutez modifiez le tableau `"styles"` en ajoutant la ligne suivante :

```
"node_modules/bootstrap/dist/css/bootstrap.min.css",
```

![add style](img/angularjsonstyle.png)

### Lancer notre projet Angular

Bon, Ã  quoi Ã§a ressemble Angular au fait ? LanÃ§ons le projet pour savoir !

Vu le nombre de fichiers, on se demande comment tout cela fonctionne. OÃ¹ se trouve `index.html` ? OÃ¹ sont les css, les js, Ã  quoi servent tous ces dossiers ?! En fait, Angular va compiler tous ces fichiers en un projet qui sera distribuÃ© sur un serveur web. Et pour cela, vous allez saisir la commande suivante :

```bash
ng serve --open
```

AprÃ¨s quelques moulinages, une page de votre navigateur devrait s'ouvrir (grÃ¢ce Ã  `--open`) ! Il s'agit de `localhost:4200` : c'est un serveur qui a Ã©tÃ© crÃ©Ã© localement (localhost, c'est votre machine), sur le port 4200.

Bravo, votre premier projet Angular est lancÃ©. Il ne manque plus qu'Ã  le personnaliser !

> Profitez d'Ãªtre sur cette page pour dÃ©couvrir de nouvelles lignes de commande et dÃ©couvrir la documentation de Angular !

> On remarque que les boutons sont moches : en fait, c'est Ã  cause du style Bootstrap que nous avons importÃ©. Eh oui, quelle idÃ©e nous avons eu lÃ , Angular vient dÃ©jÃ  avec son style (Material Design) !

![Boutons moches](img/boutons-moches.png)

Une fois les liens Ã©tudiÃ©s, allons modifier cette page : il s'agit du fichier `src/app/app.component.html`.

--- 
### Exercice
> Supprimez tout (oui, tout !) le contenu de ce fichier et Ã©crivez un simple `<h1>Hello World</h1>`. Actualisez... Euh non, n'actualisez pas : la page devrait s'actualiser toute seule Ã  chaque sauvegarde de fichier !
--- 


## Notre premier component

Angular est composÃ© en *components*. Ce sont des petites briques d'Ã©lÃ©ments sur la page qui sont rÃ©utilisables et qui auront chacune une fonctionnement qui lui est propre. 

![Components: schÃ©ma](img/angular-components-schema.png)

C'est un peu comme `body` ou `div` en HTML, mais en bien mieux !

Le component le plus  Ã©levÃ©, c'est `app-root`. On prÃ©fixe par convention les noms des components par `app`.

Dedans, on peut avoir un component pour la barre de navigation, pour un bloc de donnÃ©es (dans l'exemple, la liste de tÃ¢ches), pour une seule donnÃ©e qui sera rÃ©pÃ©tÃ©e (dans l'exemple, une tÃ¢che elle-mÃªme)...

Un des avantages, c'est que notre code pourra Ãªtre sÃ©parÃ© en plusieurs petits Ã©lÃ©ments, et plutÃ´t que d'avoir un seul fichier HTML avec 400 lignes de code, nous aurons plutÃ´t cinq ou six fichiers HTML avec beaucoup moins de code !

Au delÃ  de diviser notre code, les components permettent des interactions entre eux et des fonctionnements qui rendront dynamiques nos pages. Par exemple, comme dans l'image : vous voulez cliquer sur le lien "Completed Tasks" pour voir les tÃ¢ches complÃ©tÃ©es ? TrÃ¨s bien, au lieu de recharger toute la page, on n'a qu'Ã  changer le component des tÃ¢ches !


Pour crÃ©er votre premier component, commencez par quitter le serveur afin d'avoir de nouveau accÃ¨s Ã  la ligne de commande. Pour cela, en Ã©tant dans le terminal, faites `ctrl+c`.

Maintenant, crÃ©ez votre premier component : 

```
ng generate component tasks-list
```

Ou en raccourci :
```
ng g c tasks-list
```

La ligne de commande devait vous indiquer que trois fichiers ont Ã©tÃ© crÃ©Ã©s et un fichier a Ã©tÃ© mis Ã  jour : un dossier `tasks-list` a Ã©tÃ© crÃ©Ã© et contient tout cela !

IntÃ©grons ce composant dans notre page d'accueil en modifiant `app.component.html` :

![first component integration](img/firstcomponent-integration.png)

Votre page devrait afficher quelque chose comme Ã§a :

![Hello world](img/helloworld.png)

> Poursuivez sur les exercices 1 et 2 : [exercices](exercices.md)

> Poursuivez sur la partie 2 : [Partie 2](02.md)